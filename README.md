# Transfer-attacks-comparison
Comparing State of the art black-box attacks methods such as MI, DI, Admix, Ghost networks by attacking some robust models trained on cifar10 that are available in the robustbench leaderboad.

## Reproducing the results
- Run the following command to get correctly classified images by all sources and targets models
```bash
python data.py --sources Resnet50 --targets 1 2 3 61 --n_images 100
```
 by doing that, you discard images that were already misclassified by the targets model. The ids of images will be stored in a config file



- Run this command to evaluate the attack (`TI-FGSM.py`, `DI-FGSM.py`, `adm.py`)  
The ids of correctly classified test images will be loaded from config file generated by `data.py`
```bash
python MI-FGSM.py
```

## Results

The following results are obtained by using the default parameters of each attack, no tuning have been made.

### Query efficient meta attack
### l2
### num_images: 100 

Model | rank | Query efficient meta attack |
----------- | --- | ---------
Gowal2020Uncovering_70_16_extra | 3 | 0.84 |
Gowal2021Improving_28_10_ddpm_100m | 7 | 0.35 | 
Carmon2019Unlabeled | 23 | 0.3 |


### Source: Resnet50
### eps = 8/255
### num_images: 100 

MI-FGSM  |  TI-FGSM  |  Admix  |  VMI-FGSM  |  VNI-FGSM  |  GN-MIFGSM  |  DI-FGSM
---------|-----------|---------|------------|------------|-------------|---------
1.0      |  1.0      |  1.0    |  1.0       |  1.0       |  0.99       |  1.0
1.0      |  1.0      |  1.0    |  1.0       |  1.0       |  1.0        |  1.0
1.0      |  1.0      |  1.0    |  1.0       |  1.0       |  1.0        |  1.0
1.0      |  1.0      |  0.99   |  1.0       |  1.0       |  0.99       |  1.0
1.0      |  0.98     |  0.99   |  1.0       |  1.0       |  0.99       |  1.0
0.43     |  0.91     |  0.25   |  0.3       |  0.33      |  0.72       |  0.83


### Source: Resnet50
### eps = 16/255
### num_images: 100 

MI-FGSM  |  VMI-FGSM  |  TI-FGSM  |  GN-MIFGSM  |  DI-FGSM  |  VNI-FGSM
---------|------------|-----------|-------------|-----------|----------
0.98     |  0.97      |  0.98     |  0.98       |  0.99     |  0.97
0.98     |  0.97      |  0.96     |  0.98       |  0.99     |  0.98
0.96     |  0.96      |  0.97     |  0.99       |  0.99     |  0.96
0.97     |  0.96      |  0.95     |  0.97       |  0.99     |  0.97
0.97     |  0.96      |  0.94     |  0.97       |  0.99     |  0.96
0.18     |  0.06      |  0.68     |  0.4        |  0.65     |  0.05


### Source: Resnet50
### eps = 32/255
### num_images: 100 

MI-FGSM  |  DI-FGSM  |  TI-FGSM  |  GN-MIFGSM  |  VMI-FGSM  |  VNI-FGSM
---------|-----------|-----------|-------------|------------|----------
0.95     |  0.99     |  0.95     |  0.98       |  0.97      |  0.97
0.96     |  0.99     |  0.93     |  0.97       |  0.98      |  0.98
0.96     |  1.0      |  0.96     |  0.99       |  0.97      |  0.98
0.95     |  0.99     |  0.9      |  0.96       |  0.98      |  0.98
0.95     |  0.99     |  0.9      |  0.96       |  0.98      |  0.98
0.15     |  0.64     |  0.58     |  0.34       |  0.1       |  0.03


### Source: Model rank 7
### eps = 8/255
### num_images: 100 

DI-FGSM  |  MI-FGSM  |  TI-FGSM  |  VMI-FGSM  |  VNI-FGSM
---------|-----------|-----------|------------|----------
0.89     |  0.88     |  0.97     |  1.0       |  1.0
0.85     |  0.85     |  0.9      |  0.99      |  1.0
0.85     |  0.82     |  0.94     |  1.0       |  0.99
0.83     |  0.82     |  0.9      |  0.98      |  0.99
0.81     |  0.81     |  0.86     |  0.99      |  0.99
0.93     |  0.88     |  0.97     |  0.95      |  0.93


### Source: Model rank 7
### eps = 16/255
### num_images: 100 

DI-FGSM  |  GN-MIFGSM  |  MI-FGSM  |  TI-FGSM  |  VMI-FGSM  |  VNI-FGSM
---------|-------------|-----------|-----------|------------|----------
0.61     |  0.63       |  0.96     |  0.96     |  0.96      |  0.95
0.54     |  0.58       |  0.94     |  0.94     |  0.89      |  0.89
0.57     |  0.61       |  0.94     |  0.94     |  0.89      |  0.88
0.56     |  0.59       |  0.89     |  0.89     |  0.86      |  0.85
0.57     |  0.61       |  0.9      |  0.91     |  0.85      |  0.85
0.57     |  0.52       |  0.76     |  0.95     |  0.73      |  0.77



### Source: Carmon19
### eps = 16/255
### num_images: 100 

DI-FGSM  |  GN-MIFGSM  |  MI-FGSM  |  TI-FGSM  |  VMI-FGSM  |  VNI-FGSM
---------|-------------|-----------|-----------|------------|----------
0.62     |  0.63       |  0.97     |  0.99     |  0.95      |  0.95
0.67     |  0.71       |  0.96     |  0.96     |  0.91      |  0.92
0.57     |  0.59       |  0.95     |  0.98     |  0.92      |  0.92
0.6      |  0.64       |  0.93     |  0.92     |  0.9       |  0.9
0.63     |  0.67       |  0.93     |  0.93     |  0.91      |  0.91
0.56     |  0.54       |  0.82     |  0.95     |  0.79      |  0.82

### Source: Vanilla
### eps = 16/255
### num_images: 100 

DI-FGSM  |  GN-MIFGSM  |  MI-FGSM  |  TI-FGSM  |  VNI-FGSM
---------|-------------|-----------|-----------|----------
1.0      |  0.99       |  0.99     |  1.0      |  0.99
1.0      |  0.99       |  1.0      |  0.99     |  1.0
0.99     |  1.0        |  1.0      |  0.99     |  1.0
0.99     |  1.0        |  1.0      |  0.99     |  1.0
0.99     |  1.0        |  1.0      |  0.97     |  1.0
0.0      |  0.0        |  0.33     |  0.96     |  0.3


### MI FGSM ensemble
#### Source: Resnet50, Densenet169, Vgg19
#### num_images: 100

MI-FGSM ENS |
----------- |
1.0         |
1.0         |   
1.0         |
1.0         |
1.0         |
0.22        |


#### Source: Resnet50, Resnet18
#### num_images: 100

MI-FGSM ENS |
----------- |
1.0         |
1.0         |
1.0         |
1.0         |
1.0         |   
0.24        |


### Dast
#### Source: vgg
#### num_images: 100

| <sub>Model ID</sub> | <sub> Dast Robust accuracy</sub> |
|:---:|:---:|
| <sub>**Carmon2019Unlabeled**</sub> | <sub>99%</sub> |
| <sub>**Standard**</sub> | <sub>56%</sub> |




### TREMBA 

#### Source: resnet50
#### num_images: 100

| <sub>Model ID</sub> | <sub> Tremba Robust accuracy</sub> |
|:---:|:---:|
| <sub>**Carmon2019Unlabeled**</sub> | <sub>100%</sub> |
| <sub>**Standard**</sub> | <sub>64%</sub> |

